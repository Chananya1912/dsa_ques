<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather Widget</title>
</head>
<body>
  <h2>Weather Widget</h2>

  <!-- Input + Button -->
  <input type="text" id="city" placeholder="Enter city (default: Tokyo)">
  <button id="getWeather">Get Weather</button>

  <!-- Status -->
  <div id="status"></div>

  <!-- Weather display -->
  <div id="weather"></div>

  <script>
    document.getElementById("getWeather").addEventListener("click", async () => {
      const statusDiv = document.getElementById("status");
      const weatherDiv = document.getElementById("weather");

      // Clear old data
      weatherDiv.innerHTML = "";

      // Loading state
      console.log("Fetching weather...");
      statusDiv.textContent = "Fetching weather...";

      try {
        // API for Tokyo (lat=35, lon=139)
        const url = "https://api.open-meteo.com/v1/forecast?latitude=35&longitude=139&current_weather=true";
        const response = await fetch(url);

        if (!response.ok) {
          throw new Error("API request failed");
        }

        const data = await response.json();
        const temp = data.current_weather.temperature;
        const wind = data.current_weather.windspeed;

        // Log to console
        console.log(`Temperature: ${temp}¬∞C`);
        console.log(`Windspeed: ${wind} km/h`);

        // Show in DOM
        weatherDiv.innerHTML = `
          üå°Ô∏è Temperature: ${temp}¬∞C <br>
          üí® Windspeed: ${wind} km/h
        `;

        statusDiv.textContent = ""; // clear fetching msg
      } catch (error) {
        console.error("Weather data unavailable!");
        statusDiv.textContent = "Weather data unavailable!";
      } finally {
        console.log("Weather fetch completed");
        const completionMsg = document.createElement("p");
        completionMsg.textContent = "Weather fetch completed";
        document.body.appendChild(completionMsg);
      }
    });
  </script>
</body>
</html>
